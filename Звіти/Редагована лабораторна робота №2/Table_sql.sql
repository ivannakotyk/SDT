-- 1. Таблиця APP_USER
CREATE TABLE APP_USER (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USER_NAME VARCHAR2(100) NOT NULL,
    USER_EMAIL VARCHAR2(255) UNIQUE NOT NULL
);

-- 2. Таблиця AUDIOFILE
CREATE TABLE AUDIOFILE (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FILE_NAME VARCHAR2(500) NOT NULL,
    FILE_PATH VARCHAR2(1000),
    FILE_FORMAT VARCHAR2(50),
    AUDIOFILE_DURATION INTERVAL DAY TO SECOND, 
    SAMPLERATE NUMBER
);

-- 3. Таблиця PROJECT
CREATE TABLE PROJECTT (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROJECT_NAME VARCHAR2(255) NOT NULL,
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    UPDATED_AT TIMESTAMP,
    FILE_PATH VARCHAR2(1000),
    USER_ID NUMBER NOT NULL,
    CONSTRAINT FK_PROJECT_USER FOREIGN KEY (USER_ID) REFERENCES APP_USER(ID)
);

-- 4. Таблиця TRACK
CREATE TABLE TRACK (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    PROJECT_ID NUMBER NOT NULL,
    TRACK_NAME VARCHAR2(255),
    TRACK_ORDER NUMBER NOT NULL,
    TRACK_VOLUME NUMBER(5, 2) DEFAULT 1.0, 
    CONSTRAINT FK_TRACK_PROJECT FOREIGN KEY (PROJECT_ID) REFERENCES PROJECT(ID)
);

-- 5. Таблиця SEGMENT
CREATE TABLE SEGMENTT (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TRACK_ID NUMBER NOT NULL,
    AUDIOFILE_ID NUMBER NOT NULL,
    START_TIME NUMBER(10, 3) NOT NULL, 
    END_TIME NUMBER(10, 3) NOT NULL,
    CONSTRAINT FK_SEGMENT_TRACK FOREIGN KEY (TRACK_ID) REFERENCES TRACK(ID),
    CONSTRAINT FK_SEGMENT_AUDIOFILE FOREIGN KEY (AUDIOFILE_ID) REFERENCES AUDIOFILE(ID)
);

-- 6. Таблиця CONVERTER
CREATE TABLE CONVERTER (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    PROJECT_ID NUMBER NOT NULL,
    AUDIOFILE_ID NUMBER NOT NULL,
    CONVERSION_DATE TIMESTAMP DEFAULT SYSTIMESTAMP, 
    CONSTRAINT UQ_CONVERTER UNIQUE (PROJECT_ID, AUDIOFILE_ID), 
    CONSTRAINT FK_CONVERTER_PROJECT FOREIGN KEY (PROJECT_ID) REFERENCES PROJECT(ID),
    CONSTRAINT FK_CONVERTER_AUDIOFILE FOREIGN KEY (AUDIOFILE_ID) REFERENCES AUDIOFILE(ID)
);
